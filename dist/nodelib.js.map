{"version":3,"sources":["webpack://nodelib/webpack/bootstrap","webpack://nodelib/external \"lodash\"","webpack://nodelib/./src/node sync","webpack://nodelib/./src/node/error.coffee","webpack://nodelib/./src/node/metadata.coffee","webpack://nodelib/external \"path\"","webpack://nodelib/./src/node/route.coffee","webpack://nodelib/./src/node/index.coffee","webpack://nodelib/./src/node/context.coffee","webpack://nodelib/external \"fs\"","webpack://nodelib/external \"js-yaml\"","webpack://nodelib/./src/node/code.coffee","webpack://nodelib/external \"os\"","webpack://nodelib/./src/node/module.coffee","webpack://nodelib/(webpack)/buildin/module.js","webpack://nodelib/external \"uuid\"","webpack://nodelib/./src/node/util.coffee"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","webpackEmptyContext","req","e","Error","code","keys","resolve","id","NonExistantPathElementException","types","path","fs","yaml","_","codelib","Array","isArray","metafiles","loadDir","from_path","metap","join","metaf","existsSync","safeLoad","readFileSync","load","type","md","isEmpty","item","isObject","resolve_mvc_meta","meta","version","split","ext_version","components","comppath","compname","substring","length","readJrcModDef","from_file","dir","data","mdef","parseJrcHeader","defaults","deps","title","description","str","head","header","firstComment","indexOf","propname","substr","argstr","trim","resolveHandler","cb","core","base","applyRoutes","app","root","routes","url","replace","route","subRoutes","extend","method","console","error","apply","isString","h","Context","metadata","util","ctx_prop_spec","desc","configurable","refToPath","ref","match","init","ctx","class","_instance","_i","context","_data","_subs","prepare_from_obj","add_data","obj","k","v","prepare_property","_ctx_property","_ctxGetter","set","_ctxSetter","seed","sub","push","p_","shift","defaultValue","_deref","ls","rs","self","$ref","isPlainObject","merge","x","w","clone","_clean","mergeDeref","deref","merged","result","index","value2","key2","isNumber","isBoolean","isFunction","transform","_ctx","prop","newVal","reset","os","LineReader","EOL","eol","lines","line","isLineComment","cleanLineComment","lineReader","hasNext","next","uuid","applyParams","params","param","handler","Component","opts","server","pkg","config","controllers","models","log","load_controllers","Base","plugin","cs","load_controller_names","update_controller","warn","modpath","modelPath","define","modelbase","ctrl_path","ctrl","updateObj","err","comp","Core","controllerPath","viewPath","load_models","apply_controllers","default_route","defroute","all","redirect","core_path","core_file","__noderoot","core_seed_cb","CoreV01","use","res","locals","configure","mod","modroot","src","mods","fullpath","ModuleV01","comps","union","values","listen","DEFAULT_METADATA","mdc","SUPPORTED","load_from_metadata","CoreClass","ModuleClass","module_classes","session","instances","projects","apps","node_path","app_path","code_id","v4","global","load_core","__approot","app_id","__appid","classes","Module","load_and_start","process","cwd","load_modules","start","webpackPolyfill","deprecate","paths","children","errors","errs","forEach","message","indexof","arr","filter","doc","idx","matched","findByParam"],"mappings":"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","file":"nodelib.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = require(\"lodash\");","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 1;","\nclass NonExistantPathElementException extends Error\n  null\n\nmodule.exports =\n  types:\n    NonExistantPathElementException: NonExistantPathElementException\n\n\n","###\n\nLoad metadata for directories/files.\nData is stored in local files, can be in different formats.\n\nThis could get quite extensive. Currently only read YAML.\n\nWant some centralized or integrated storage (xattr, ldap)?\n\n###\n\npath = require 'path'\nfs = require 'fs'\nyaml = require 'js-yaml'\n_ = require 'lodash'\n\ncodelib = require './code'\n\n\ntypeIsArray = Array.isArray ||\n  ( value ) -> return {}.toString.call( value ) is '[object Array]'\n\n# TODO: metafile should support various directory formats\n#metafiles = [ 'main.*', 'module.*', '.meta' ]\nmetafiles = [ 'main.meta', 'module.meta', '.meta' ]\n\nloadDir = ( from_path ) ->\n  for metaf in metafiles\n    metap = path.join( from_path, metaf )\n    if fs.existsSync metap\n      return yaml.safeLoad fs.readFileSync metap, 'utf8'\n\nload = ( from_path, type ) ->\n  md = loadDir from_path\n  if _.isEmpty md\n    return\n  if _.isEmpty type\n    return md\n  if _.isArray md\n    for item in md\n      if item.type?\n        if item.type == type\n          return item\n  if _.isObject md\n    if md.type?\n      if md.type == type\n        return md\n    return null\n\n\n# Parse, fetch and return MVC metadata for module\nresolve_mvc_meta = ( from_path, meta ) ->\n\n  version = meta.type.split('/')[1]\n  meta.path = from_path\n  meta.ext_version = version\n\n  if not meta.components\n    meta.components = [ 'models', 'views', 'controllers' ]\n\n  for compname in meta.components\n    comppath = path.join( from_path, compname )\n    pathprop = compname.substring(0, compname.length-1) + 'Path'\n    meta[ pathprop ] = comppath\n\n  #for compname in meta.components\n  #  compidx = require comppath\n\n  #  if typeIsArray( compidx )\n  #    compcbs = compidx\n  #  else\n  #    compcbs = [ compidx ]\n\n  #  comps = []\n  #  for compcb in compcbs\n  #    if _.isFunction compcb\n  #      comps.push compcb meta\n  #    else\n  #      comps.push compcb\n\n  #  #meta[ compname ] = comps\n\n  meta\n\nmodule.exports =\n\n  loadDir: loadDir\n  load: load\n  resolve_mvc_meta: resolve_mvc_meta\n  readJrcModDef: ( md, name ) ->\n    from_file = path.join md.dir\n    data = fs.readFileSync from_file, 'ascii'\n    mdef = parseJrcHeader data\n    _.defaults mdef,\n      id: path.join md.name\n      deps: null\n      title: null\n      description: null\n  parseJrcHeader: ( str ) ->\n    header = codelib.firstComment str\n    m = {}\n    for head in header\n      p = head.indexOf ' '\n      if p == -1\n        continue\n      propname = head.substr 0, p\n      argstr = head.substr p+1\n      p = propname.indexOf ':'\n      if p == -1\n        continue\n      prefix = propname.substr 0, p\n      if prefix != 'jrc'\n        continue\n      key = propname.substr p+1\n      if key == 'export'\n        m.id = argstr.trim()\n      if key == 'import'\n        deps = argstr.trim().split(' ')\n        m.deps = deps\n      if key == 'description'\n        m.description = argstr.trim()\n      if key == 'title'\n        m.title = argstr.trim()\n    m\n\n","module.exports = require(\"path\");","###\nMetadata to Express helpers.\n\n###\n_ = require 'lodash'\n\n\n# XXX Init one-off controller instance to handle str-spec callback..\nresolveHandler = (module, cb) ->\n  [ type, name ] = cb.substr( 0, cb.length - 1 ).split('(')\n  core = module.core\n  new core.base.type[ type ]( module, name )\n\n\napplyRoutes = (app, root, module) ->\n\n  if !app\n    throw new Error \"Missing app\"\n\n  routes = {}\n  for name, route of module.route\n    # full url\n    url = [ root, name ].join('/').replace('$', ':')\n    # recurse to sub-route\n    if route.route\n      subRoutes = applyRoutes app, url, route\n      _.extend routes, subRoutes\n    # apply current level\n    for method in ['all', 'get', 'put', 'post', 'options', 'delete']\n      cb = route[method]\n      if cb\n        #console.log url, method\n        # Track all routes?\n        if url not of routes\n          routes[url] = {}\n        if method of routes[url]\n          console.error \"Already routed: \", method, url\n        routes[url][method] = cb\n        # Apply to Express; ie. app.get( url, callback )\n        if _.isArray cb\n          app[method].apply app, [ url, cb... ]\n        else if _.isString cb\n          h = resolveHandler( module, cb )\n          app[method] url, _.bind h[method], h\n        else\n          app[method] url, cb\n\n  routes\n\n\nmodule.exports =\n\n  applyRoutes: applyRoutes\n\n","# Id: nodelib/0.0.8 src/node/index.coffee\n\nversion = \"0.0.8\" # nodelib\n\n\nmodule.exports =\n  Context: require './context'\n  metadata: require './metadata'\n  module: require './module'\n  route: require './route'\n  error: require './error'\n  util: require './util'\n  version: version\n\n#\n","###\nA coffeescript implementation of a context\nwith inheritance and override.\n\nSee also dotmpe/invidia for JS\n###\n_ = require 'lodash'\n\nerror = require './error'\n\n\nctx_prop_spec = ( desc ) ->\n  _.defaults desc,\n    enumerable: false\n    configurable: true\n\nrefToPath = ( ref ) ->\n  if not ref.match /^#\\/.*/\n    throw new Error \"Absolute JSON ref only support\"\n  ref.substr(2)\n    .replace(/([^\\\\])\\//g, '$1.')\n    .replace(/\\\\\\//g, '/')\n\n\nclass Context\n\n  ###\n    Obj. hierarchy with dynamic, inherited properties.\n  ###\n\n  constructor: ( init, ctx=null ) ->\n    @class = Context\n    @_instance = ++ Context._i\n    # Provide path to super context\n    @context = ctx\n    # XXX unused @_defaults = init\n    @_data = {}\n    @_subs = []\n    # XXX: re-create all properties from context, needed?\n    # Also what if wait until local is overriden..\n    if ctx and ctx._data\n      @prepare_from_obj ctx._data\n    # add properties for, and seed from init into local data\n    @add_data init\n\n  id: -> if @context then @context.id() + '.' + @_instance else @_instance\n  toString: -> 'Context:' + @id()\n  isEmpty: -> _.isEmpty @_data and if @context then @context.isEmpty() else true\n  subs: -> @_subs # List subcontexts\n  root: ->\n    ctx = @\n    while ctx.context\n      ctx = ctx.context\n    ctx\n\n  # Seed property data from obj\n  seed: ( obj ) ->\n    for k, v of obj\n      @_data[ k ] = v\n    @\n\n  # Create local properties using keys in obj (ignores existing data keys)\n  prepare_from_obj: ( obj ) ->\n    for k, v of obj\n      @prepare_property k\n    @\n\n  prepare_all: ( keys ) ->\n    for k in keys\n      @prepare_property k\n    @\n\n  prepare_property: ( k ) ->\n    if k of @_data\n      return\n    @_ctx_property k,\n      get: @_ctxGetter( k )\n      set: @_ctxSetter( k )\n    @\n\n  # Short cut for adding new attributes from data\n  add_data: ( obj ) -> @prepare_from_obj obj; @seed obj\n\n  # new subcontext, inherits current instance, optional new or override vars\n  getSub: ( init ) ->\n    Sub = class extends @class\n    sub = new Sub init, @\n    @_subs.push sub\n    sub\n\n  # get an object by json path reference,\n  get: ( p_ ) ->\n    p = p_.replace(/([^\\\\])\\./g, '$1\\n')\n      .replace(/\\\\\\./, '.').split '\\n'\n    c = @\n    while p.length\n      name = p.shift()\n      if name of c\n        c = c[ name ]\n      else\n        console.error \"no #{name} of #{p_} in\", c\n        throw new error.types.NonExistantPathElementException(\n          \"Unable to get #{name} of #{p_}\" )\n    c\n\n  put: ( p_, v ) ->\n    p = p_.replace(/([^\\\\])\\./g, '$1\\n')\n      .replace(/\\\\\\./, '.').split '\\n'\n    c = @\n    while p.length-1\n      name = p.shift()\n      if name of c\n        c = c[ name ]\n      else\n        console.error \"no #{name} of #{p_} in\", c\n        throw new error.types.NonExistantPathElementException(\n          \"Unable to get #{name} of #{p_}\" )\n    name = p.shift()\n    c[name] = v\n    null\n\n  # get an object by json path reference,\n  # and resolve all contained references too\n  resolve: ( p_, defaultValue ) ->\n    p = p_.replace(/([^\\\\])\\./g, '$1\\n')\n      .replace(/\\\\\\./, '.').split '\\n'\n    c = self = @\n\n    # resolve an object with $ref key\n    _deref = (o) ->\n      ls = o\n      rs = self.get refToPath o.$ref\n      if _.isPlainObject rs\n        rs = _.merge ls, rs\n      rs\n\n    # replace current with referenced path\n    if '$ref' of c\n      try\n        c = _deref c\n      catch err\n        if defaultValue?\n          return defaultValue\n        throw err\n\n    while p.length\n\n      # replace current with sub at next path element\n      name = p.shift()\n\n      if name of c\n        c = c[ name ]\n\n        #if not _.isPlainObject( c )\n        if not _.isObject( c )\n          continue\n\n        if '$ref' of c\n          try\n            c = _deref c\n          catch err\n            if defaultValue?\n              return defaultValue\n            throw err\n\n      else\n        console.error \"no #{name} of #{p_} in\", c\n        throw new Error \"Unable to resolve #{name} of #{p_}\"\n\n    if _.isPlainObject c\n      x = @merge c\n      if x.$ref\n        return x.$ref\n      return x\n    c\n\n  # XXX drop $ref from return value\n  _clean: ( c ) ->\n    for k, v of c\n      if _.isPlainObject v\n        w = _.clone v\n        if '$ref' of w\n          delete w.$ref\n        @_clean w\n        c[k] = w\n    c\n\n  # recurive resolve\n  merge: ( c ) ->\n    self = @\n    # recursively replace $ref: '..' with dereferenced value\n    # XXX this starts top-down, but forgets context. may need to globalize\n    mergeDeref = ( value ) ->\n      deref = self.get refToPath value.$ref\n      if _.isPlainObject deref # recurse\n        merged = self.merge deref\n        delete value.$ref\n        value = _.merge value, merged\n      else\n        value = deref\n    merge = ( result, value, key ) ->\n      if '$ref' is key\n        value = mergeDeref $ref: value\n        return\n      if _.isArray value\n        for item, index in value\n          merge value, item, index\n      else if _.isPlainObject(value) or value instanceof Context\n        if '$ref' of value\n          value = mergeDeref value\n        else\n          for key2, value2 of value\n            merge value, value2, key2\n\n      else if value == null or _.isString( value ) or _.isNumber( value ) \\\n          or _.isBoolean( value ) or _.isFunction( value )\n        null\n\n      else\n        throw new Error \"Unhandled value '#{value}'\"\n\n      result[ key ] = value\n\n      result\n\n    _.transform c, merge\n\n  to_dict: ->\n    d = {}\n    _ctx = @\n    while _ctx\n      d = _.merge d, _ctx._data\n      _ctx = _ctx.context\n    d\n\n\n  ## Private functions\n\n  _ctx_property: ( prop, desc ) ->\n    ctx_prop_spec desc\n    Object.defineProperty @, prop, desc\n\n  # return a getter for property `k`: returns local data or tries context\n  _ctxGetter: ( k ) ->\n    ->\n      if k of @_data\n        @_data[ k ]\n      else if @context?\n        @context[ k ]\n\n  # return a setter for property `k`: set into local data\n  _ctxSetter: ( k ) ->\n    ( newVal ) ->\n      @_data[ k ] = newVal\n\n\n  ## Class funcs\n\n  @count: ->\n    return Context._i\n\n  @reset: ->\n    Context._i = 0\n\n\n# Class vars\nContext.reset()\n# XXX: not strict: Context.name = \"context-mpe\"\n\nmodule.exports = Context\n","module.exports = require(\"fs\");","module.exports = require(\"js-yaml\");","os = require 'os'\n\n_ = require 'lodash'\n\n\nclass LineReader\n  constructor: ( @str, @eol = os.EOL, @lines = [] ) ->\n  hasNext: ->\n    return ! _.isEmpty @str\n  next: ->\n    line\n    p = @str.indexOf @eol\n    if p > -1\n      line = @str.substr 0, p\n      @str = @str.substr p + @eol.length\n    else\n      line = @str\n      @str = ''\n    @lines.push line\n    return line\n\nisLineComment = ( line ) ->\n  line.trim().substr(0, 1) == '#'\n\ncleanLineComment = ( line ) ->\n  line.trim().substr(1).trim()\n\nfirstComment = ( str ) ->\n  lines = []\n  lineReader = new LineReader str\n  while lineReader.hasNext()\n    line = lineReader.next()\n    if isLineComment line\n      lines.push cleanLineComment line\n  lines\n\nmodule.exports =\n  firstComment: firstComment\n  isLineComment: isLineComment\n  cleanLineComment: cleanLineComment\n","module.exports = require(\"os\");","###\n\n.mpe 2015 Some code to quickly start an extensible Express app.\n\n  'express-mvc/0.1'\n\n  'express-mvc-ext/0.1'\n\n###\npath = require 'path'\n\n_ = require 'lodash'\nuuid = require 'uuid'\n\nmetadata = require './metadata'\napplyRoutes = require('./route').applyRoutes\n\napplyParams = ( app, context ) ->\n  if context.params\n    for name, handler of context.params\n      app.param( name, handler )\n\n\nclass Component\n\n  constructor: ( opts ) ->\n    {@app, @server, @root, @pkg, @config, @meta, @url, @path, @route} = opts\n    @base = {}\n    @controllers = {}\n    @routes = {}\n    @models = {}\n    @params = {}\n\n  @load_config: ( name ) ->\n    {}\n\n  configure: ->\n    console.log \"TODO component.configure\", [\n      @name, @meta, @base, @path, @route ]\n    @load_controllers()\n\n  load_models: ->\n    #knex = @app.get('knex.main')\n    #if not knex\n    #  knex = require('knex')(@config.database.main)\n    #  @app.set('knex.main', knex)\n    #  #console.log(chalk.grey('Initialized main DB conn'))\n    # FIXME Component.load_models\n    #Base = Bookshelf.initialize(knex)\n    #@modelbase = Bookshelf.session = Base\n    # Prepare Bookshelf.{model,collection} registries\n    Base.plugin 'registry'\n\n  load_controllers: ->\n    if ! @meta.controllers\n      console.warn 'No controllers for component', @name\n      return\n\n    cs = @meta.controllers\n    if _.isArray cs\n      @load_controller_names()\n    else if _.isObject( cs ) and not _.isEmpty cs\n      @update_controller cs\n\n  load_model: ( name ) ->\n    if not @models[name]\n      modpath = path.join @modelPath, name\n      @models[name] = require(modpath).define(@modelbase)\n    @models[name]\n\n  load_controller_names: ->\n    p = @root || @path\n\n    # load configured controllers\n    for ctrl in @meta.controllers\n\n      ctrl_path = path.join( p, ctrl )\n      @controllers[ ctrl ] = require ctrl_path\n      try\n        updateObj = @controllers[ ctrl ] @, @base\n      catch err\n        console.error \"Unable to load #{ctrl}\"\n        throw err\n\n      @update_controller updateObj\n\n      console.log \"Component: #{@name} loaded\", ctrl, \"controller\"\n\n  update_controller: ( updateObj ) ->\n    #console.log @meta, updateObj\n    # update global meta object\n    comp = @core || @\n    if updateObj.meta\n      _.merge comp.meta, updateObj.meta\n\n    if updateObj.params\n      # keep params at local module\n      _.merge @params, updateObj.params\n\n    if updateObj.route\n      # keep routes at local module\n      _.merge @route, updateObj.route\n\n\nclass Core extends Component\n\n  constructor: (opts) ->\n    super opts\n    @name = @name || 'core'\n\n  configure: ->\n    p = @root || @path\n\n    @name = @name || @meta.name\n\n    if not @controllerPath\n      @controllerPath = path.join p, 'controllers'\n    if not @modelPath\n      @modelPath = path.join p, 'models'\n    if not @viewPath\n      @viewPath = path.join p, 'views'\n\n    @load_models()\n    @load_controllers()\n    @apply_controllers()\n\n  apply_controllers: ->\n    # pick of new routes from updateObj\n    _.extend @routes, applyRoutes( @app, @url, @ )\n\n    applyParams @app, @\n\n    if @meta.default_route\n      defroute = path.join( @url, @meta.default_route )\n      @app.all @url, @base.redirect(defroute)\n\n  # static init for core, relay app init to core module, then init\n  @config: ( md, core_path ) ->\n    core_file = path.join __noderoot, core_path, 'main'\n    core_seed_cb = require core_file\n    # Return core opts\n    opts = core_seed_cb core_path\n    _.defaults opts, route: {}\n    opts\n\n\nclass CoreV01 extends Core\n\n  ###\n\n  | Encapsulate Express MVC for extension.\n  | XXX what to use for models?\n\n  - views\n  - models\n  - controllers\n\n  ###\n\n  constructor: (opts) ->\n    super opts\n    @modules = {}\n\n  configure: ->\n    # url must point to netpath, WITHOUT any *path* part (ie. including root)\n    # so any sub-component can deal with abs or rel paths\n    @url = @url || ''\n    #@viewPath = @app.get 'views'\n    @modelPath = path.join @root, 'models'\n\n    # Add some more locals for Jade templates\n    self = @\n    @app.use (req, res, next) ->\n      res.locals.core = self\n      res.locals.modules = []\n      next()\n\n    super() # BUG: must add parenthesis? ... new after 1.12.2 to 2.4.1 upgrade\n\n  ###\n    CoreV01.load_modules\n  ###\n  load_modules: ->\n    modroot = path.join __noderoot, @config.src || 'src'\n    mods = _.extend( [], @config.modules, @meta.modules )\n    for modpath in mods\n      fullpath = path.join( modroot, modpath )\n      mod = ModuleV01.load( @, fullpath )\n      mod.configure()\n      @modules[ mod.meta.name ] = mod\n      console.log 'Loaded module', modpath, mod.meta.name\n      console.log mod.route\n\n  ###\n    CoreV01.get_all_components\n  ###\n  get_all_components: ->\n    comps = [ @ ]\n    _.union comps, _.values( @modules )\n\n  start: ->\n    self = @\n    @server.listen @app.get(\"port\"), ->\n      console.log \"Express server listening on port \" + self.app.get(\"port\")\n\n  # Static\n\n  @DEFAULT_METADATA: [\n    type: 'express-mvc-core/0.2'\n  ]\n\n  @SUPPORTED: [ 'express-mvc-core/0.1', 'express-mvc-core/0.2' ]\n\n  @load: ( core_path ) ->\n    md = metadata.load core_path\n    if !md\n      console.warn \"No metadata for core\", core_path\n      md = CoreV01.DEFAULT_METADATA\n    for mdc in md\n      if not 'type' of mdc\n        continue\n      if mdc.type in CoreV01.SUPPORTED\n        return CoreV01.load_from_metadata core_path, mdc\n    throw new Error \"No known core interface on module at #{core_path}\"\n\n  @load_from_metadata: ( core_path, mdc ) ->\n    # XXX sync with module.load\n    CoreClass = CoreV01\n    #md = metadata.resolve_mvc_meta core_path, mdc\n    #CoreClass = module_classes[ md.ext_version ]\n    opts = CoreClass.config [ mdc ], core_path\n    return new CoreClass opts\n\n\nclass ModuleV01 extends Component\n\n  ###\n\n  | Handle Express MVC extension modules.\n\n  - handlers\n  - routes\n\n  ###\n\n  # Get new instance holding module metadata and config.\n  constructor: ( opts ) ->\n    if !opts.name\n      opts.name = 'ModuleV01'\n    super opts\n    {@core} = opts\n\n  # Static\n\n  @DEFAULT_METADATA: [\n    type: 'express-mvc-ext/0.2'\n  ]\n\n  @SUPPORTED: [ 'express-mvc-ext/0.1', 'express-mvc-ext/0.2' ]\n\n  @load: ( core, from_path ) ->\n    md = metadata.load from_path\n    if !md\n      console.warn \"No metadata for module\", from_path\n      md = ModuleV01.DEFAULT_METADATA\n    for mdc in md\n      if not 'type' of mdc\n        continue\n      if mdc.type in ModuleV01.SUPPORTED\n        return ModuleV01.load_from_metadata core, from_path, mdc\n    throw new Error \"No known extension interface on module at #{from_path}\"\n\n  @load_from_metadata: ( core, from_path, mdc ) ->\n    md = metadata.resolve_mvc_meta from_path, mdc\n    if !md.controllers\n      console.error \"Missing MVC meta for \", mdc\n    ModuleClass = module_classes[ md.ext_version ]\n    opts = ModuleClass.config core, md, from_path\n    return new ModuleClass opts\n\n  @config: ( core, md, from_path ) ->\n    meta: md || name: md.name\n    config: md.config || {}\n    route: md.route || {}\n    core: core\n    app: core.app\n    base: core.base\n    path: from_path\n\n\nmodule_classes = {\n  '0.1': ModuleV01\n  '0.2': ModuleV01\n}\n\n# set globals to track projects and apps\n#\nsession = {\n  instances: { },\n  projects: { },\n  apps: { }\n}\n\ninit = ( node_path, app_path=null ) ->\n  if not session.projects[node_path]\n    code_id = uuid.v4()\n    session.projects[node_path] = code_id\n  else\n    code_id = session.projects[node_path]\n\n  global.__noderoot = node_path\n\n\nload_core = ( app_path ) ->\n  global.__approot = app_path\n  app_id\n\n  if not session.apps[app_path]\n    app_id = uuid.v4()\n    session.apps[app_path] = app_id\n  else\n    app_id = session.apps[app_path]\n\n  global.__appid = app_id\n\n  if not session.instances[app_id]\n    session.instances[app_id] = core = CoreV01.load( app_path )\n\n  else\n    core = session.instances[app_id]\n\n  core\n\n\nload_module = ( mod_path ) ->\n  module.configure extroot\n  module.load app\n\n\nmodule.exports = {\n  session: session\n  init: init\n  classes:\n    Core: CoreV01\n    Module: ModuleV01\n  load_core: load_core,\n  #load_module: load_module,\n  load_and_start: ( app_path ) ->\n    init process.cwd()\n    core = load_core app_path\n    core.configure()\n    core.load_modules()\n    core.start()\n}\n\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","module.exports = require(\"uuid\");","###*\n# Formats mongoose errors into proper array\n#\n# @param {Array} errors\n# @return {Array}\n# @api public\n###\n\nexports.errors = (errors) ->\n  keys = Object.keys(errors)\n  errs = []\n  # if there is no validation error, just display a generic error\n  if !keys\n    return [ 'Oops! There was an error' ]\n  keys.forEach (key) ->\n    errs.push errors[key].message\n    return\n  errs\n\n###*\n# Index of object within an array\n#\n# @param {Array} arr\n# @param {Object} obj\n# @return {Number}\n# @api public\n###\n\nexports.indexof = (arr, obj) ->\n  index = -1\n  # not found initially\n  keys = Object.keys(obj)\n  # filter the collection with the given criterias\n  result = arr.filter((doc, idx) ->\n    # keep a counter of matched key/value pairs\n    matched = 0\n    # loop over criteria\n    i = keys.length - 1\n    while i >= 0\n      if doc[keys[i]] == obj[keys[i]]\n        matched++\n        # check if all the criterias are matched\n        if matched == keys.length\n          index = idx\n          return idx\n      i--\n    return\n  )\n  index\n\n###*\n# Find object in an array of objects that matches a condition\n#\n# @param {Array} arr\n# @param {Object} obj\n# @param {Function} cb - optional\n# @return {Object}\n# @api public\n###\n\nexports.findByParam = (arr, obj, cb) ->\n  index = exports.indexof(arr, obj)\n  if ~index and typeof cb == 'function'\n    return cb(undefined, arr[index])\n  else if ~index and !cb\n    return arr[index]\n  else if ! ~index and typeof cb == 'function'\n    return cb('not found')\n  # else undefined is returned\n  return\n"],"sourceRoot":""}
